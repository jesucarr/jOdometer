/*
 * jOdometer (1.4.2) // 2012.08.13 // <http://www.frontendmatters.com/projects/jquery-plugins/jodometer/>
 *
 * REQUIRES jQuery 1.2.3+ <http://jquery.com/>
 *
 * Copyright (c) 2008 TrafficBroker <http://www.trafficbroker.co.uk>
 * Licensed under GPL and MIT licenses
 *
 * jOdometer is a counter that works like an odometer: moving the numbers up like a wheel
 *
 * Usually we will need a "position: relative" and an "overflow: hidden" in the container element.
 *
 * Sample Configuration:
 * $('.counter').jOdometer({increment: 3.17, counterStart:'0087.15', counterEnd:'0159.50', numbersImage: '/images/numbers.png', spaceNumbers: 2, offsetRight:5});
 *
 * Config Options:
 * counterStart: Number we are starting with. To get a specific number of digits/decimals it have to be a string (e.g. '0005.50') // Default: '0000.00'
 * counterEnd: The counter stop when reach this number. If it is the same as counterStart the odometer is static. False to don't stop never. // Default: false
 * delayTime: Delay between each number change // Default: 1000
 * increment: Number increment after each delayTime // Default: 0.01
 * speed: Speed for the change number animation // Default: 500
 * easing: Easing for the change number animation. Other than 'swing' or 'linear' must be provided by plugin // Default: 'swing'
 * numbersImage: Image used for the numbers. You can use .psd provided // Default: '/images/numbers.png'
 * heightNumber: The height that each number needs // Default: 31
 * widthNumber: Width of the numbers' image // Default: 14
 * offsetRight: Distance to the right // Default: 0
 * spaceNumbers: Separation between the numbers' columns // Default: 0
 * widthDot: Decimal dot's special width // Default: 10
 * formatNumber: Whether to format the number with commas every 3 digits // Default: false
 * maxDigits: Maximum digits. If set will allow odo to 'grow' to the left for maxDigits digits w/out leading 0s. If 0 does nothing. // Default: 0
 * prefixChar: Whether to display a prefix character (16th element in numbersImage). Only works if maxDigits > 0 // Default: true
 *
 * We can override the defaults with:
 * $.fn.jOdometer.defaults.spaceNumbers = 1;
 * It returns an object used for counter manipulation. Available Functions:
 * goToNumber(number): Updates the counter with the number given. Example:
 * var counter = $('.counter').jOdometer({...});
 * counter.goToNumber(100);
 *
 * @param  settings  An object with configuration options
 * @author    Jesus Carrera <jesus.carrera@frontendmatters.com>
 *
 * Credits:
 * Tom Fotherby (added comma formatting) <https://github.com/tomfotherby>
 * Charlie Kindel (added maxDigits) <https://github.com/tig>
 */(function(e){e.fn.jOdometer=function(t){function b(r){if(r!=undefined){clearInterval(y);if(parseInt(r)<parseInt(s)){var u=t.maxDigits==0?o.length:t.maxDigits;for(h=0;h<u;h++)o[h]="",t.maxDigits&&e(".jodometer_integer_"+h).hide(),e(".jodometer_integer_"+h,n).animate({top:i},0,"linear");t.prefixChar&&(o[0]="0",e(".jodometer_integer_0").show(),e(".jodometer_integer_0",n).animate({top:i},0,"linear"),e(".jodometer_integer_1").show(),e(".jodometer_integer_1",n).animate({top:15*t.heightNumber*-1},1,"linear"))}s=r,w(s)}else w(s),s+=t.increment;t.counterEnd!=0&&s>=t.counterEnd&&(clearInterval(y),w(t.counterEnd))}function w(r){a=String(r).split(".");if(u.length>0)for(h=0;h<u.length;h++)oldDigit=u[h],a[1]&&(u[h]=a[1].charAt(h)),u[h]==""&&(u[h]="0"),E(e(".jodometer_decimal_"+h,n),parseInt(u[h]),parseInt(oldDigit));p=a[0],c=p.length-1;var s=t.maxDigits==0?o.length:t.maxDigits;for(h=0;h<s;h++)oldDigit=o[h],c>=0&&(o[h]=p.charAt(c)),o[h]==""&&t.maxDigits==0&&(o[h]="0"),oldDigit==""&&(t.prefixChar?(c==-1&&(e(".jodometer_integer_"+h,n).animate({top:15*t.heightNumber*-1},1,"linear"),e(".jodometer_integer_"+h,n).show()),c==0&&(oldDigit="0",e(".jodometer_integer_"+h,n).show()),c>=1&&(e(".jodometer_integer_"+h,n).animate({top:i},0,"linear"),e(".jodometer_integer_"+h,n).show(),oldDigit="0")):c>=0&&(e(".jodometer_integer_"+h,n).show(),oldDigit="0")),E(e(".jodometer_integer_"+h,n),parseInt(o[h]),parseInt(oldDigit)),c--}function E(e,n,r){if(isNaN(n)||isNaN(r))return this;n!=r&&(e.stop(),n==0?e.animate({top:10*t.heightNumber*-1+i},t.speed,t.easing).animate({top:i},1,"linear"):n<r?e.animate({top:10*t.heightNumber*-1+i},t.speed*((10-r)/10),"linear").animate({top:i},1,"linear").animate({top:n*t.heightNumber*-1+i},t.speed*r/10,t.easing):e.animate({top:n*t.heightNumber*-1+i},t.speed,t.easing))}if(this.length>1)return this.each(function(){e(this).jOdometer(t)}),this;t=e.extend({},e.fn.jOdometer.defaults,t),this.goToNumber=function(e){b(e)};var n=e(this),r=this,i=-t.heightNumber,s=parseFloat(t.counterStart),o=[],u=[],a=String(t.counterStart).split("."),f=0,l=0;if(a[1]){var c=0;for(var h=a[1].length-1;h>-1;h--)u[h]=a[1].charAt(h),e(this).append('<img style="position:absolute; right:'+(c*t.widthNumber+t.offsetRight+c*t.spaceNumbers)+"px; top:"+(parseInt(u[h])*t.heightNumber*-1+i)+'px;" class="jodometer_decimal_'+h+'" src="'+t.numbersImage+'" alt="Decimal '+(h+1)+'" />'),c++;e(this).append('<div style="position:absolute; width:'+t.widthDot+"px; height:"+t.heightNumber+"px; background:url("+t.numbersImage+") no-repeat center "+(12*t.heightNumber*-1+i)+"px; right:"+(a[1].length*t.widthNumber+t.offsetRight+a[1].length*t.spaceNumbers)+'px;" class="jodometer_dot"></div>'),f=a[1].length,l=t.widthDot}var p=a[0],c=p.length-1,d=0,v=t.maxDigits==0?p.length:t.maxDigits;for(var h=0;h<v;h++){h<p.length?o[h]=p.charAt(c):o[h]="",t.formatNumber&&h>0&&h%3==0&&(e(this).append('<div style="position:absolute; width:'+t.widthDot+"px; "+"height:"+t.heightNumber+"px; "+"background:url("+t.numbersImage+") "+"no-repeat center bottom; "+"right:"+(h*t.widthNumber+f*t.widthNumber+l+d+t.offsetRight+f*t.spaceNumbers+h*t.spaceNumbers+t.spaceNumbers)+"px;"+'" class="jodometer_dot"></div>'),d+=t.widthDot+t.spaceNumbers);var m="";c<0&&(m="display:none; ");var g=parseInt(o[h]);t.prefixChar&&c==-1&&(m="",g=14),e(this).append('<img style="'+m+"position:absolute; "+"right:"+(h*t.widthNumber+f*t.widthNumber+l+d+t.offsetRight+f*t.spaceNumbers+h*t.spaceNumbers+t.spaceNumbers)+"px; "+"top:"+(g*t.heightNumber*-1+i)+"px;"+'" class="jodometer_integer_'+h+'" src="'+t.numbersImage+'" alt="Integer '+(h+1)+'" />'),c--}if((parseFloat(t.counterStart)!=t.counterEnd||t.counterEnd.toString()=="false"&&parseFloat(t.counterStart)==0)&&t.delayTime>0)var y=setInterval(function(){b()},t.delayTime);return this},e.fn.jOdometer.defaults={counterStart:"0000.00",counterEnd:!1,delayTime:1e3,increment:.01,speed:500,easing:"swing",numbersImage:"/images/jodometer-numbers.png",formatNumber:!1,heightNumber:31,widthNumber:14,offsetRight:0,spaceNumbers:0,widthDot:10,maxDigits:0,prefixChar:!1}})(jQuery);